---
import BlogCard from '@/components/BlogCard.astro'
import Link from '@/components/Link.astro'
import ManPageHero from '@/components/ManPageHero.astro'
import PageHead from '@/components/PageHead.astro'
import TuiCard from '@/components/port/TuiCard'
import TuiHeading from '@/components/TuiHeading.astro'
import { buttonVariants } from '@/components/ui/button'
import { SITE } from '@/consts'
import Layout from '@/layouts/Layout.astro'
import { getRecentPosts } from '@/lib/data-utils'

const blog = await getRecentPosts(SITE.featuredPostCount)
---

<Layout>
  <PageHead slot="head" title="Home" />
  <section class="">
    <ManPageHero />
  </section>
  <section class="flex flex-col gap-3">
    <!-- Row 1: Vertical Header + Post 1 -->
    <div class="flex flex-col md:grid md:grid-cols-[auto_1fr] md:gap-x-6">
      <div
        class="relative z-10 flex justify-center md:h-full md:w-fit md:justify-start"
      >
        <TuiCard
          client:load
          className="compact max-h-fit px-6 pt-6 pb-3 md:flex md:h-full md:rotate-180 md:items-center md:justify-center md:px-3 md:py-6 md:[writing-mode:vertical-rl]"
        >
          <TuiHeading level={2}>Latest posts</TuiHeading>
        </TuiCard>
      </div>

      {
        blog[0] && (
          <div class="h-full flex-1">
            <BlogCard entry={blog[0]} className="h-full" />
          </div>
        )
      }
    </div>

    <!-- Row 2: Post 2 + Vertical Button -->
    <div class="flex flex-col gap-4 md:grid md:grid-cols-[1fr_auto] md:gap-x-6">
      {
        blog[1] && (
          <div class="md:flex-1">
            <BlogCard entry={blog[1]} />
          </div>
        )
      }

      <div class="z-10 flex justify-center md:w-fit md:justify-start">
        <TuiCard
          client:load
          className="group-button compact px-6 pt-6 pb-3 md:flex md:rotate-180 md:items-center md:justify-center md:px-3 md:py-6 md:[writing-mode:vertical-rl]"
        >
          <Link
            href="/blog"
            class={buttonVariants({ variant: 'ghost' }) +
              ' group hover:bg-transparent whitespace-nowrap !p-0 !h-auto text-base font-semibold'}
          >
            See all posts <span
              class="ml-1.5 inline-block transition-transform group-hover:translate-x-1 md:rotate-90 md:group-hover:translate-x-0 md:group-hover:translate-y-1"
              >&rarr;</span
            >
          </Link>
        </TuiCard>
      </div>
    </div>
  </section>
</Layout>
